<h2>ЁЯТ░ роиро┐родро┐ ро╡роЪрпВро▓рпН рокроЯрпНроЯро┐ропро▓рпН</h2>

<!-- ЁЯФ╣ Total Fund -->
<p style="font-weight:bold; font-size:14px;">
  роорпКродрпНрод роиро┐родро┐: тВ╣ <%= @funds.sum(:amount) %>
</p>

<!-- ЁЯФН Search -->
<%= form_with url: fund_collections_path, method: :get, local: true do %>
  <input type="text"
         name="search"
         placeholder="рокрпЖропро░рпН / рокроХрпБродро┐"
         value="<%= params[:search] %>">
  <input type="submit" value="родрпЗроЯрпБ">
<% end %>

<br>

<!-- ЁЯУД PDF + ЁЯЦия╕П Print -->
<%= link_to "ЁЯУД PDF",
    fund_collections_path(
      format: :pdf,
      search: params[:search],
      sort: params[:sort],
      direction: params[:direction]
    ),
    target: "_blank",
    style: "margin-right:10px;" %>

<button onclick="window.print()">ЁЯЦия╕П Print</button>

<br><br>

<% if @funds.any? %>
  <table border="1" cellpadding="8" cellspacing="0" width="100%">
    <thead>
      <tr style="background:#f2f2f2;">

        <!-- ЁЯСд Name -->
        <th>
          <%= link_to "рокрпЖропро░рпН",
              fund_collections_path(
                search: params[:search],
                sort: "name",
                direction: params[:direction] == "asc" ? "desc" : "asc"
              ) %>
          <% if params[:sort] == "name" %>
            <%= params[:direction] == "asc" ? "тмЖя╕П" : "тмЗя╕П" %>
          <% end %>
        </th>

        <!-- ЁЯПа Area -->
        <th>
          <%= link_to "роКро░рпН",
              fund_collections_path(
                search: params[:search],
                sort: "area",
                direction: params[:direction] == "asc" ? "desc" : "asc"
              ) %>
          <% if params[:sort] == "area" %>
            <%= params[:direction] == "asc" ? "тмЖя╕П" : "тмЗя╕П" %>
          <% end %>
        </th>

        <!-- ЁЯТ░ Amount -->
        <th>
          <%= link_to "родрпКроХрпИ (тВ╣)",
              fund_collections_path(
                search: params[:search],
                sort: "amount",
                direction: params[:direction] == "asc" ? "desc" : "asc"
              ) %>
          <% if params[:sort] == "amount" %>
            <%= params[:direction] == "asc" ? "тмЖя╕П" : "тмЗя╕П" %>
          <% end %>
        </th>

        <!-- ЁЯТ│ Payment -->
        <th>
          <%= link_to "рокрогроорпН роЪрпЖро▓рпБродрпНродрпБроорпН роорпБро▒рпИ",
              fund_collections_path(
                search: params[:search],
                sort: "payment_mode",
                direction: params[:direction] == "asc" ? "desc" : "asc"
              ) %>
          <% if params[:sort] == "payment_mode" %>
            <%= params[:direction] == "asc" ? "тмЖя╕П" : "тмЗя╕П" %>
          <% end %>
        </th>

        <!-- ЁЯУЕ Date -->
        <th>
          <%= link_to "родрпЗродро┐",
              fund_collections_path(
                search: params[:search],
                sort: "created_at",
                direction: params[:direction] == "asc" ? "desc" : "asc"
              ) %>
          <% if params[:sort] == "created_at" %>
            <%= params[:direction] == "asc" ? "тмЖя╕П" : "тмЗя╕П" %>
          <% end %>
        </th>

        <th>роЪрпЖропро▓рпНроХро│рпН</th>
      </tr>
    </thead>

    <tbody>
      <% @funds.each do |fund| %>
        <tr>
          <td><%= fund.name %></td>
          <td><%= fund.area %></td>
          <td>тВ╣ <%= fund.amount %></td>
          <td><%= fund.payment_mode.capitalize %></td>
          <td><%= fund.created_at.strftime("%d-%m-%Y") %></td>
          <td>
            <%= link_to "тЬПя╕П родро┐ро░рпБродрпНродрпБ",
                edit_fund_collection_path(fund),
                style: "margin-right:6px;" %>

            |

            <!-- тЬЕ RAILS 7 DELETE (FIXED) -->
            <%= link_to "ЁЯЧСя╕П роирпАроХрпНроХрпБ",
                fund_collection_path(fund),
                data: {
                  turbo_method: :delete,
                  turbo_confirm: "роЗроирпНрод рокродро┐ро╡рпИ роирпАроХрпНроХ ро╡рпЗрогрпНроЯрпБрооро╛?"
                },
                style: "color:red; font-weight:bold;" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <br>

  <!-- ЁЯУД Pagination -->
  <%= paginate @funds %>

<% else %>
  <p>роЗрокрпНрокрпЛродрпБ роОроирпНрод роиро┐родро┐ рокродро┐ро╡рпБроорпН роЗро▓рпНро▓рпИ.</p>
<% end %>

<br>

<!-- тЮХ New Fund -->
<%= link_to "тЮХ рокрпБродро┐роп роиро┐родро┐ роЪрпЗро░рпНроХрпНроХ",
    new_fund_collection_path,
    style: "font-weight:bold;" %>
